{
  "Content": "The cf-release v238 was released on June 27, 2016.\n\n**IMPORTANT**\n- **Known issue**: The [WebDAV blobstore and Cloud Controller API / Clock / Worker jobs are unable to start after a VM restart](https://github.com/cloudfoundry/capi-release/issues/25) because creation of the run directory for each process, `/var/vcap/data/sys/run/*`, was moved to the bosh pre-start script. The jobs are unable to start because `/var/vcap/data/sys/run` is mounted on a temporary file-system and the bosh pre-start script is not executed on VM restart, only deployment. A fix is in the pipeline for CF-240. To workaround this issue, operators can do a `bosh deploy`, which will recognize the failing jobs and properly create the run directory.\n- v238 includes a fix for [CVE-2016-4468](http://pivotal.io/security//cve-2016-4468), UAA SQL Injection. The mitigation is to upgrade to cf-release v238\n- Cloud Controller and other components of capi-release now use [bosh pre-start job-lifecycle scripts](http://bosh.io/docs/pre-start.html) for many startup tasks including database migrations. This capability requires bosh-release v206+ (1.3072.0) and requires releases deployed with 3125+ stemcells.\n\n**Contents:**\n- \u003ca href='#cc-and-service-broker-apis'\u003eCC and Service Broker APIs\u003c/a\u003e\n- \u003ca href='#dea-warden-hm9000-runtime'\u003eDEA-Warden-HM9000 Runtime\u003c/a\u003e\n- \u003ca href='#buildpacks-and-stacks'\u003eBuildpacks and Stacks\u003c/a\u003e\n- \u003ca href='#identity'\u003eIdentity\u003c/a\u003e\n- \u003ca href='#routing'\u003eRouting\u003c/a\u003e\n- \u003ca href='#loggregator'\u003eLoggregator\u003c/a\u003e\n- \u003ca href='#internal-components'\u003eInternal Components\u003c/a\u003e\n- \u003ca href='#job-spec-changes'\u003eJob Spec Changes\u003c/a\u003e\n- \u003ca href='#recommended-bosh-stemcell-versions'\u003eRecommended BOSH Stemcell Versions\u003c/a\u003e\n- \u003ca href='#recommended-versions-additional-releases'\u003eRecommended Versions of Additional Releases\u003c/a\u003e\n\n## \u003ca name='cc-and-service-broker-apis'\u003e\u003c/a\u003eCC and Service Broker APIs\n\n**CC API Version: [2.57.0](http://apidocs.cloudfoundry.org/238)**\n\n**Service Broker API Version: [2.9](http://docs.cloudfoundry.org/services/api.html)**\n\n#### [CAPI Release](https://github.com/cloudfoundry/capi-release/tree/546deac73d9ab12090d4034ab9cf1c0358580db2)\n- Add blobstore timeout configuration [details](https://www.pivotaltracker.com/story/show/85494788)\n- Add configuration to run multiple blobstore nginx workers per core [details](https://www.pivotaltracker.com/story/show/121160469)\n- Update nginx to 1.11.1 [details](https://www.pivotaltracker.com/story/show/120881245)\n- Bridge components only support `properties.capi` [details](https://www.pivotaltracker.com/story/show/119691761)\n\n#### [Cloud Controller](https://github.com/cloudfoundry/cloud_controller_ng/tree/2157be5c9c56d46649c61441f552c30d268332aa)\n- Make minimum candidate stagers configurable [details](https://www.pivotaltracker.com/story/show/119999895)\n- Use hm9000 internal address when making requests [details](https://www.pivotaltracker.com/story/show/119396151)\n- Add missing event types to API documentation [details](https://www.pivotaltracker.com/story/show/116094963)\n- Enforce space quota on route creation [details](https://www.pivotaltracker.com/n/projects/1358110/stories/102184500)\n- Client author should be able to follow CC API docs to configure total reserved route ports when creating a space quota [details](https://www.pivotaltracker.com/n/projects/1358110/stories/102184500)\n- Retry blobstore requests before failing [details](https://www.pivotaltracker.com/story/show/85494788)\n- hm9000 client handles socket error when internal hm9000 address does not exist [details](https://www.pivotaltracker.com/n/projects/900612/stories/118507195)\n- Emit error when consul is down [details](https://www.pivotaltracker.com/n/projects/900612/stories/118507195)\n- Add optional description to security group rule [details](https://www.pivotaltracker.com/story/show/99729506)\n- Domain helper used in check_for_domain_overlap doesn't work when a second domain appears in list in addition to the system domain [details](https://www.pivotaltracker.com/story/show/120641049)\n- `/v2/routes` and `/v2/apps/:guid/routes` and `/v3/apps/:guid/routes` return a deprecated url format for domains. [details](https://www.pivotaltracker.com/story/show/91147816)\n- Emit error when consul is down [details](https://github.com/cloudfoundry/cloud_controller_ng/pull/610)\n- Allow Shared Domains to be seeded through the manifest [details](https://www.pivotaltracker.com/n/projects/1358110/stories/119410709)\n- Sequel `sql_log_level` is 'debug', not 'debug2' [details](https://github.com/cloudfoundry/cloud_controller_ng/commit/c155c3c3a439d706a573451b392253ab4635f228)\n- Move database migrations and seeding into bosh pre-start. Move buildpack installation into bosh post-start. Run cloud controller scripts as `vcap` user. [details](https://www.pivotaltracker.com/story/show/118417177)\n- Updating service broker with non-unique service plan name fails to provide offending service and plan info. [details](https://www.pivotaltracker.com/story/show/119694493)\n- EXPERIMENTAL: When Cloud Controller starts an app on Diego and has a service binding containing volume_mounts, it should desire an LRP with volume mounts [details](https://www.pivotaltracker.com/story/show/116719225)\n- V3 Experimental\n  - As a space developer, I can map a route to a specific process type on a specific port [details](https://www.pivotaltracker.com/story/show/111334688)\n  - As a space auditor, I should NOT be able to download packages or droplets [details](https://www.pivotaltracker.com/story/show/119555419)\n  - v3 process examples in docs should show stats link [details](https://www.pivotaltracker.com/story/show/120125883)\n  - Droplet memory_limit field should be staging_memory_in_mb [details](https://www.pivotaltracker.com/story/show/117477287)\n  - Droplet disk_limit field should be staging_disk_in_mb [details](https://www.pivotaltracker.com/story/show/117780413)\n  - As a SpaceAuditor, I expect to never see sensitive information [details](https://www.pivotaltracker.com/story/show/117965037)\n  - As a SpaceManager, I expect to have oznly READ access for all V3 endpoints [details](https://www.pivotaltracker.com/story/show/117877157)\n  - As a space developer, I can get the list of droplets associated with a package [details](https://www.pivotaltracker.com/story/show/99017802)\n  - As an API consumer, I should be able to filter /v3/droplets and /v3/apps/:guid/droplets [details](https://www.pivotaltracker.com/story/show/118413293)\n- Service Broker API\n  - Add service_id and plan_id to last_operation calls to service brokers [details](https://www.pivotaltracker.com/story/show/114769745)\n  - Support for broker operation identifier for provision [details](https://www.pivotaltracker.com/story/show/120654839)\n  - Support for broker operation identifier for deprovision [details](https://www.pivotaltracker.com/story/show/120595477)\n  - Support for broker operation identifier for update [details](https://www.pivotaltracker.com/story/show/120595531)\n  - EXPERIMENTAL: Translate service broker volume mounts to diego volume mounts [details](https://www.pivotaltracker.com/n/projects/1518687/stories/116719225)\n\n#### [TPS](https://github.com/cloudfoundry-incubator/tps/tree/eadeccb88608257fad1c154d1623beb9ce1571ca)\n- Support ActualLRPCrashedEvent from BBS in TPS [details](https://www.pivotaltracker.com/story/show/118877145)\n\n###### Pull Requests and Issues\n- cloudfoundry/cloud_controller_ng#551: Missing service/plan id for async last_operation call [details](https://www.pivotaltracker.com/story/show/114769745)\n- cloudfoundry/cloud_controller_ng#573: SpaceManager / SpaceAuditor could not see private domain [details](https://www.pivotaltracker.com/story/show/117306051)\n- cloudfoundry/cloud_controller_ng#597: The \"Updating an App\" documentation makes it look like I can update the `detected_start_command` [details](https://www.pivotaltracker.com/story/show/119231999)\n\n## \u003ca name='dea-warden-hm9000-runtime'\u003e\u003c/a\u003eDEA-Warden-HM9000 Runtime\n- Bumped to ruby 2.3.1\n- Improved HM9000 performance\n\n**Known issues**\n- Container metrics via CLI are 100x larger than reality.\n\n## \u003ca name='buildpacks-and-stacks'\u003e\u003c/a\u003eBuildpacks and Stacks\n\nSupport for .profile pre-runtime hooks. [Documentation can be found here](https://docs.cloudfoundry.org/devguide/deploy-apps/deploy-app.html#profile)   \n\n### stacks\n\nupdated to 1.67.0 (from 1.56.0)\n\n#### [1.67.0](https://github.com/cloudfoundry/stacks/releases/tag/1.67.0)\n\n#### [1.66.0](https://github.com/cloudfoundry/stacks/releases/tag/1.66.0)\n\n#### [1.65.0](https://github.com/cloudfoundry/stacks/releases/tag/1.65.0)\n\n#### [1.64.0](https://github.com/cloudfoundry/stacks/releases/tag/1.64.0)\n\n#### [1.63.0](https://github.com/cloudfoundry/stacks/releases/tag/1.63.0)\n\n#### [1.62.0](https://github.com/cloudfoundry/stacks/releases/tag/1.62.0)\n\n#### [1.61.0](https://github.com/cloudfoundry/stacks/releases/tag/1.61.0)\n\n#### [1.60.0](https://github.com/cloudfoundry/stacks/releases/tag/1.60.0)\n\n#### [1.59.0](https://github.com/cloudfoundry/stacks/releases/tag/1.59.0)\n\n#### [1.58.0](https://github.com/cloudfoundry/stacks/releases/tag/1.58.0)\n\n#### [1.57.0](https://github.com/cloudfoundry/stacks/releases/tag/1.57.0)\n\n### java-buildpack\n\nupdated to v3.7.1 (from v3.7)\n\n#### [v3.7.1](https://github.com/cloudfoundry/java-buildpack/releases/tag/v3.7.1)\n\n### nodejs-buildpack\n\nupdated to v1.5.15 (from v1.5.14)\n\n#### [v1.5.15](https://github.com/cloudfoundry/nodejs-buildpack/releases/tag/v1.5.15)\n\n### php-buildpack\n\nupdated to v4.3.14 (from v4.3.12)\n\n#### [v4.3.14](https://github.com/cloudfoundry/php-buildpack/releases/tag/v4.3.14)\n\n#### [v4.3.13](https://github.com/cloudfoundry/php-buildpack/releases/tag/v4.3.13)\n\n### python-buildpack\n\nupdated to v1.5.6 (from v1.5.5)\n\n#### [v1.5.6](https://github.com/cloudfoundry/python-buildpack/releases/tag/v1.5.6)\n\n### ruby-buildpack\n\nupdated to v1.6.19 (from v1.6.17)\n\n#### [v1.6.19](https://github.com/cloudfoundry/ruby-buildpack/releases/tag/v1.6.19)\n\n#### [v1.6.18](https://github.com/cloudfoundry/ruby-buildpack/releases/tag/v1.6.18)\n\n### staticfile-buildpack\n\nupdated to v1.3.9 (from v1.3.8)\n\n#### [v1.3.9](https://github.com/cloudfoundry/staticfile-buildpack/releases/tag/v1.3.9)\n\n## \u003ca name='identity'\u003e\u003c/a\u003eIdentity\n\nUpdated to UAA Release 3.4.1\n- [UAA 3.4.1 Release Notes](https://github.com/cloudfoundry/uaa/releases/tag/3.4.1)\n- [UAA 3.4.0 Release Notes](https://github.com/cloudfoundry/uaa/releases/tag/3.4.0)\n\n## \u003ca name='routing'\u003e\u003c/a\u003eRouting\n- Operator can now use manifest property `uaa.ca_cert` to configure a custom CA used to sign the SSL cert hosted by UAA [details](https://www.pivotaltracker.com/story/show/121257767)\n- Quota attribute `total_reserved_route_ports` is now unlimited for BOSH Lite manifest generated using `./scripts/generate-bosh-lite-dev-manifest`  [details](https://www.pivotaltracker.com/story/show/119110725)\n- Manifest properties have been updated for gorouter; see below [details](https://www.pivotaltracker.com/story/show/118616645), [details](https://www.pivotaltracker.com/story/show/118260777)\n- Some processes on the router job no longer run as root [details](https://www.pivotaltracker.com/story/show/118973723)\n- Gorouter now uses cgo netdns (instead of Go's DNS resolver), which supports EDNS0 [details](https://www.pivotaltracker.com/story/show/119964953)\n\n## \u003ca name='loggregator'\u003e\u003c/a\u003eLoggregator\n- Add  loggregator etcd ssl properties to  cf-release template [details](https://www.pivotaltracker.com/story/show/121255441)\n- Add handshake timeout and set DisableKeepAlive in noaa consumer [details](https://www.pivotaltracker.com/story/show/121060799)\n- Initial work on tagged metrics: changes to dropsonde. Not yet ready for use.\n- Doppler supports Etcd TLS [details](https://www.pivotaltracker.com/story/show/120783335)\n- Metron supports Etcd TLS [details](https://www.pivotaltracker.com/story/show/120783365)\n- TC supports Etcd TLS [details](https://www.pivotaltracker.com/story/show/120783341)\n- Syslog Drain Binder supports Etcd TLS [details](https://www.pivotaltracker.com/story/show/120783381)\n- Include Forwarded Addresses in HttpStartStop [details](https://www.pivotaltracker.com/story/show/118761839)\n- Loggregator components emit metrics regarding open file handles/connections [details](https://www.pivotaltracker.com/story/show/116101163)\n- Pull AZ information from BOSH in trafficontroller [details](https://www.pivotaltracker.com/story/show/121326321)\n- Pull Zone (when available) From Bosh 2.0 in Metron and Doppler [details](https://www.pivotaltracker.com/story/show/121080065)\n- Remove preferred_protocol property from docs [details](https://www.pivotaltracker.com/story/show/118487409)\n- Traffic Controller should timeout when failing to talk to the UAA or CC over SSL [details](https://www.pivotaltracker.com/story/show/120860353)\n- cloudfoundry/noaa #15: Set consumer to open after connection goroutines are closed [details](https://www.pivotaltracker.com/story/show/118052177)\n- cloudfoundry/sonde-go #2: Make top-level package go-gettable [details](https://www.pivotaltracker.com/story/show/117681881)\n\n## \u003ca name='internal-components'\u003e\u003c/a\u003eInternal Components\n\n#### consul\n- consul-release was bumped from v80 to [v92](https://github.com/cloudfoundry-incubator/consul-release/releases/tag/v92).  Significant changes:\n  - Fixes a bug in `confab`, the wrapper program for orchestrating the start of the `consul` binary. The previous behaviour was that if `confab` is started a second time, it will kill the previously running `consul` process, leaving nothing running. The new correct behaviour is for `confab` to fail if `consul` is already running, but not kill `consul`. [details](https://pivotaltracker.com/story/show/115660337)\n  - Bump `consul` binary from version 0.5.2 to 0.6.4, and `consul-template` binary from version 0.9.0 to 0.14.0. [details](https://pivotaltracker.com/story/show/113007637)\n  - Long-running processes in the `consul_agent` job now run as `vcap` rather than `root`. [details](https://www.pivotaltracker.com/story/show/119388013)\n\n#### etcd and etcd-metrics-server\n- etcd-release was bumped from v48 to [v57](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v57).  Significant changes:\n  - Long-running processes in the `etcd` job now run as `vcap` rather than `root`. [details](https://www.pivotaltracker.com/story/show/119387367)\n  - Long-running processes in the `etcd_metrics_server` job now run as `vcap` rather than `root`. [details](https://www.pivotaltracker.com/story/show/119387869)\n  - `etcd_metrics_server` job supports talking to `etcd` via mutual TLS. [details](https://www.pivotaltracker.com/story/show/121468207)\n  - Add `etcd-proxy` job in service of zero-downtime upgrades from a non-TLS etcd cluster to a TLS etcd cluster. The zero-downtime upgrade work is currently a work in progress. [details](https://pivotaltracker.com/story/show/121870543)\n\n#### postgres\n\nNo changes.\n\n#### nats and nats_stream_forwarder\n- nats-release was bumped from 01ee06a4cab572a87417a25a886ad933bfa183a0 to [219e93bdb8a8e9fc0734fb0640b8b8d6edc14c3f](https://github.com/cloudfoundry/nats-release/commit/219e93bdb8a8e9fc0734fb0640b8b8d6edc14c3f).  Significant changes:\n  - Long-running processes in the `nats` job now run as `vcap` rather than `root`. [details](https://www.pivotaltracker.com/story/show/119389047)\n  - Long-running processes in the `nats_stream_forwarder` job now run as `vcap` rather than `root`. [details](https://www.pivotaltracker.com/story/show/119389043)\n\n## \u003ca name='job-spec-changes'\u003e\u003c/a\u003eJob Spec Changes\n- Add property `cc.minimum_candidate_stagers`, the number of candidate DEAs for staging, with default of 5.\n- Add property `hm9000.port` for configuring how Cloud Controller communicates with DEAs, with no default. This is used to generate `hm9000.internal_url` in the Cloud Controller configuration. If not using DEAs / HM9000, this port is unused, but required.\n- Add properties `cc.resource_pool.webdav_config.blobstore_timeout`, `cc.packages.webdav_config.blobstore_timeout`, `cc.droplets.webdav_config.blobstore_timeout`, `cc.buildpacks.webdav_config.blobstore_timeout`, each with defaults of 5 seconds.\n- Add property `blobstore.nginx_workers_per_core` with default of 2. This is used when configuring blobstore instances serving WebDAV.\n- Add `fog_aws_storage_options` to blobstore configuration properties. These each accept a hash, with the only valid key being `encryption`. Set `fog_aws_storage_options` to `{'encryption' =\u003e 'AES256'}` in order to encrypt files at rest in S3.\n  - `cc.resource_pool.fog_aws_storage_options`\n  - `cc.packages.fog_aws_storage_options`\n  - `cc.droplets.fog_aws_storage_options`\n  - `cc.buildpacks.fog_aws_storage_options`\n- CC Bridge Properties moved from `properties.diego` to `properties.capi`:\n  - `diego.cc_uploader` -\u003e `capi.cc_uploader`\n  - `diego.nsync` -\u003e `capi.nsync`\n  - `diego.stager` -\u003e `capi.stager`\n  - `diego.tps` -\u003e `capi.tps`\n- Gorouter property changes:\n  - Removed `router.skip_oauth_tls_verification`\n  - Removed `metron_endpoint.host`\n  - Removed `metron_endpoint.port`\n  - Removed `metron_endpoint.dropsonde_port`\n  - Removed `dropsonde.enabled`\n  - Renamed `routing-api.port` to `routing_api.port`\n  - Renamed `routing-api.auth_disabled` to `routing_api.auth_disabled`\n  - Added `metron.port`\n\n## \u003ca name='recommended-bosh-stemcell-versions'\u003e\u003c/a\u003eRecommended BOSH Stemcell Versions\n- AWS: light-bosh-stemcell-3232.11-aws-xen-hvm-ubuntu-trusty-go_agent\n- vSphere: bosh-stemcell-3232.11-vsphere-esxi-ubuntu-trusty-go_agent\n- OpenStack: N/A\n- BOSH-Lite: bosh-stemcell-3147-warden-boshlite-ubuntu-trusty-go_agent\n\nThese are soft recommendations; several different versions of the stemcells are likely to work fine with this version of cf-release and the corresponding versions of the additional releases listed below.\n\n## \u003ca name='recommended-versions-additional-releases'\u003e\u003c/a\u003eRecommended Versions of Additional Releases\n\nThese versions are soft recommendations, as several different versions of these releases may work correctly with this version of cf-release.\n- Diego release [v0.1476.0](https://github.com/cloudfoundry/diego-release/tree/v0.1476.0).\n  Release notes for\n  [v0.1476.0](https://github.com/cloudfoundry/diego-release/releases/tag/v0.1476.0) ·\n  [v0.1475.0](https://github.com/cloudfoundry/diego-release/releases/tag/v0.1475.0) ·\n  [v0.1474.0](https://github.com/cloudfoundry/diego-release/releases/tag/v0.1474.0) ·\n  [v0.1473.0](https://github.com/cloudfoundry/diego-release/releases/tag/v0.1473.0).\n- Garden-Linux release [v0.338.0](https://github.com/cloudfoundry-incubator/garden-linux-release/tree/v0.338.0).\n  Release notes for\n  [v0.338.0](https://github.com/cloudfoundry-incubator/garden-linux-release/releases/tag/v0.338.0).\n- etcd release [v57](https://github.com/cloudfoundry-incubator/etcd-release/tree/v57). Release notes for\n  [v57](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v57) ·\n  [v56](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v56) ·\n  [v55](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v55) ·\n  [v54](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v54) ·\n  [v53](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v53) ·\n  [v52](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v52) ·\n  [v51](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v51) ·\n  [v50](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v50).\n- cflinuxfs2-rootfs release [v1.16.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/tree/v1.16.0).\n  Release notes for\n  [v1.16.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.16.0) ·\n  [v1.15.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.15.0) ·\n  [v1.14.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.14.0) ·\n  [v1.13.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.13.0) ·\n  [v1.12.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.12.0) ·\n  [v1.11.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.11.0) ·\n  [v1.10.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.10.0) ·\n  [v1.9.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.9.0) ·\n  [v1.8.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.8.0) ·\n  [v1.7.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.7.0) ·\n  [v1.6.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.6.0).\n"
}