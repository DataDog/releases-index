{
  "Content": "The cf-release v239 was released on July 13, 2016.\n\n**IMPORTANT**\n- **Known issue**: The [WebDAV blobstore and Cloud Controller API / Clock / Worker jobs are unable to start after a VM restart](https://github.com/cloudfoundry/capi-release/issues/25) because creation of the run directory for each process, `/var/vcap/data/sys/run/*`, was moved to the bosh pre-start script. The jobs are unable to start because `/var/vcap/data/sys/run` is mounted on a temporary file-system and the bosh pre-start script is not executed on VM restart, only deployment. A fix is in the pipeline for CF-240. To workaround this issue, operators can do a `bosh deploy`, which will recognize the failing jobs and properly create the run directory.\n- In an effort to not run processes as a privileged user, the WebDAV blobstore must now run on unprivileged ports. By default, internal access has been moved to port 4443 and the external access to port 8080. As the WebDAV blobstore is a SPOF, internal components using the blobstore will not be able to reach the blobstore until all processes have been reconfigured to use the new internal port. This will cause limited downtime in the sense that anything needing to reach the blobstore will fail until the deployment is complete, including app pushes, app restaging, and app restarting. This will happen automatically for users of CF manifest generation scripts. See \u003ca href='#job-spec-changes'\u003eJob Spec Changes\u003c/a\u003e.\n- Cloud Foundry now defaults to run containers on Diego in unprivileged mode. One known incompatibility is running applications that use FUSE file system support. See \u003ca href='#job-spec-changes'\u003eJob Spec Changes\u003c/a\u003e for instructions on how to continue running containers in privileged mode.\n- The `noaa` library for connecting to the firehose has a number of reliability improvements. If you use it, it is recommended that you upgrade to the latest version.\n\n**Contents:**\n- \u003ca href='#cc-and-service-broker-apis'\u003eCC and Service Broker APIs\u003c/a\u003e\n- \u003ca href='#dea-warden-hm9000-runtime'\u003eDEA-Warden-HM9000 Runtime\u003c/a\u003e\n- \u003ca href='#buildpacks-and-stacks'\u003eBuildpacks and Stacks\u003c/a\u003e\n- \u003ca href='#identity'\u003eIdentity\u003c/a\u003e\n- \u003ca href='#routing'\u003eRouting\u003c/a\u003e\n- \u003ca href='#loggregator'\u003eLoggregator\u003c/a\u003e\n- \u003ca href='#internal-components'\u003eInternal Components\u003c/a\u003e\n- \u003ca href='#job-spec-changes'\u003eJob Spec Changes\u003c/a\u003e\n- \u003ca href='#recommended-bosh-stemcell-versions'\u003eRecommended BOSH Stemcell Versions\u003c/a\u003e\n- \u003ca href='#recommended-versions-additional-releases'\u003eRecommended Versions of Additional Releases\u003c/a\u003e\n\n## \u003ca name='cc-and-service-broker-apis'\u003e\u003c/a\u003eCC and Service Broker APIs\n\n**CC API Version: [2.58.0](http://apidocs.cloudfoundry.org/239)**\n\n**Service Broker API Version: [2.9](http://docs.cloudfoundry.org/services/api.html)**\n\n#### [CAPI Release](https://github.com/cloudfoundry/capi-release/tree/299a84437aa96ea6b4d7d7c4952121039d17c7e6)\n- As an operator, I expect all CF processes to run as least privileged user [details](https://www.pivotaltracker.com/story/show/118417177)\n- As a CF operator, I would like to be able to configure whether or not Diego / Garden creates privileged containers for LRPs and Tasks [details](https://www.pivotaltracker.com/story/show/121154097)\n- Monit hangs when nfs is not available [details](https://www.pivotaltracker.com/story/show/121711865)\n- As a CF user, I would like Diego to validate the SHA checksum of my droplet before running it [details](https://www.pivotaltracker.com/story/show/110124086)\n\n#### [Cloud Controller](https://github.com/cloudfoundry/cloud_controller_ng/tree/65961a953b9ffd5b1b3c0717a6b7a403748ba988)\n- operator should be able to use a manifest property to seed a shared domain and associate it with a TCP router group on deploy of cf-release [details](https://www.pivotaltracker.com/story/show/119410709)\n- operator should be able to use manifest property to configure reservable route port quota for initial deploys [details](https://www.pivotaltracker.com/story/show/120696961)\n- As an admin, I expect to be able to disable access to /v2/apps/:guid/env and /v3/apps/:guid/env for all users with a feature flag [details](https://www.pivotaltracker.com/story/show/121329423)\n- As an Operator, I would like files in my S3 blobstore to be encrypted at rest using SSE-S3 [details](https://www.pivotaltracker.com/story/show/120864401)\n- app_stop, app_start are potentially not locking properly,  especially when iterating over processes [details](https://www.pivotaltracker.com/story/show/120036085)\n- Users can remove themselves from Orgs and Spaces [details](https://www.pivotaltracker.com/story/show/119838653)\n- Authentication failures should not show as api errors in new relic [details](https://www.pivotaltracker.com/story/show/118221751)\n- Docker apps should not be pushable by admin when diego_docker is turned off. [details](https://www.pivotaltracker.com/story/show/121512823)\n\n#### [TPS](https://github.com/cloudfoundry-incubator/tps/tree/ea8a8c8bb2342894ffaea932a9f23b640ef66a48)\n- As a CF user, I expect to see an uptime of 0 and no container metrics for crashed app instances on Diego [details](https://www.pivotaltracker.com/story/show/114054925)\n\n###### Pull Requests and Issues\n- cloudfoundry/cloud_controller_ng#598: CloudController still chooses the DEA which is almost full to do app staging if the DEA number is less than 5 [details](https://www.pivotaltracker.com/story/show/119362989)\n- cloudfoundry/cloud_controller_ng#602: Listing of user-provided service instances by organization GUID does not work with IN operator [details](https://www.pivotaltracker.com/story/show/119522871)\n\n## \u003ca name='dea-warden-hm9000-runtime'\u003e\u003c/a\u003eDEA-Warden-HM9000 Runtime\n- dmesg has been locked down  [details](https://www.pivotaltracker.com/story/show/ 122067135) \n\n#### DEA\n- Fix order of magnitude in CPU consumption reported by cf app [details](https://www.pivotaltracker.com/story/show/121045883) \n- DEA is guaranteed to heartbeat during evacuation  [details](https://www.pivotaltracker.com/story/show/121024273)\n- Update ruby to version 2.3.1\n\n#### Warden\n- Warden containers' dns_servers can be specified [details](https://www.pivotaltracker.com/story/show/121110169) \n- Update ruby version to 2.3.1\n\n#### HM9000\n- when an evacuating heartbeat is received send a start message for each app instance [details](https://www.pivotaltracker.com/story/show/121024273) \n- Start messages to Cloud Controller are over HTTPS\n- Evacuator now sends start messages after creation [details](https://www.pivotaltracker.com/story/show/118577239)\n- Sender now sends stop messages over http [details](https://www.pivotaltracker.com/story/show/112003161)\n- All messages from HM9000 to Cloud Controller are over HTTPS\n\n## \u003ca name='buildpacks-and-stacks'\u003e\u003c/a\u003eBuildpacks and Stacks\n\n### stacks\n\nupdated to 1.69.0 (from 1.67.0)\n\n#### [1.69.0](https://github.com/cloudfoundry/stacks/releases/tag/1.69.0)\n\n#### [1.68.0](https://github.com/cloudfoundry/stacks/releases/tag/1.68.0)\n\n### java-buildpack\n\nupdated to v3.8.1 (from v3.7.1)\n\n#### [v3.8.1](https://github.com/cloudfoundry/java-buildpack/releases/tag/v3.8.1)\n\n#### [v3.8](https://github.com/cloudfoundry/java-buildpack/releases/tag/v3.8)\n\n### python-buildpack\n\nupdated to v1.5.7 (from v1.5.6)\n\n#### [v1.5.7](https://github.com/cloudfoundry/python-buildpack/releases/tag/v1.5.7)\n\n## \u003ca name='identity'\u003e\u003c/a\u003eIdentity\n\nNo Changes\n\n## \u003ca name='routing'\u003e\u003c/a\u003eRouting\n- Update router manifest properties, see below [details](https://www.pivotaltracker.com/story/show/118616645)\n- Manifest generation will now set the property `uaa.zones.internal.hostnames` to `[\"uaa.service.cf.internal\"]` if  no stub overrides that value. This is in support of routing components contacting UAA over its internal TLS port. [details](https://www.pivotaltracker.com/story/show/121523545)\n- Fix issue where GoRouter was not sending logs to syslog. [details](https://www.pivotaltracker.com/story/show/123657121)\n- Thanks to Jonty Wareing from the UK Government Digital Service, Gorouter now supports the PROXY protocol [details](https://www.pivotaltracker.com/story/show/116601821)\n  - **Warning**: An issue was found with PROXY protocol support where, when enabled, the Gorouter is unable to accept concurrent connections. PROXY protocol support is disabled by default.\n\n## \u003ca name='loggregator'\u003e\u003c/a\u003eLoggregator\n- The `noaa` library for connecting to the firehose has a number of reliability improvements. If you use it, it is recommended that you upgrade to the latest version.\n- Expose Metron URL Through Bosh 2.0 Links [details](https://www.pivotaltracker.com/story/show/121080431)\n- Fix the race condition in NOAA [details](https://www.pivotaltracker.com/story/show/123230731)\n- Manage logs endpoint auth token lifecycle (was:cloudfoundry/noaa #14: Reconnection token failed) [details](https://www.pivotaltracker.com/story/show/117511657)\n- Remove AZ property from Traffic Controller [details](https://www.pivotaltracker.com/story/show/121903225)\n\n## \u003ca name='internal-components'\u003e\u003c/a\u003eInternal Components\n\n#### consul\n\nNo changes.\n\n#### etcd and etcd_metrics_server\n- etcd-release was bumped from v57 to [v58](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v58).  Significant changes:\n  - Improved how operators configure `etcd_metrics_server` to work with a secure TLS etcd cluster. [details](https://pivotaltracker.com/story/show/121468207)\n\n#### postgres\n- All long-running processes in `postgres` job now run as `vcap` instead of `root`. [details](https://www.pivotaltracker.com/story/show/119387381)\n\n#### nats and nats_stream_forwarder\n\nNo changes.\n\n## \u003ca name='job-spec-changes'\u003e\u003c/a\u003eJob Spec Changes\n- Added `etcd_metrics_server.etcd.dns_suffix` property to `etcd_metrics_server` job to support configuring the job to talk to the secure `etcd` server. [details](https://pivotaltracker.com/story/show/121468207).\n- `blobstore.tls.port` now defaults to 4443 and must be above 1024. When using WebDAV blobstore, the Cloud Controller must now be configured with the same port by adding `:4443` to `cc.buildpacks.webdav_config.private_endpoint`, `cc.droplets.webdav_config.private_endpoint`, `cc.packages.webdav_config.private_endpoint`, and `cc.resource_pool.webdav_config.private_endpoint`.\n- `blobstore.port` now defaults to 8080 and must be above 1024. This port should also be configured for the `route_registrar` running alongside the blobstore:\n\n```\n      route_registrar:\n        routes:\n        - name: blobstore\n          port: 8080\n```\n- Added `capi.nsync.diego_privileged_containers` (default `false`) to run containers on Diego in unprivileged mode. Must be changed to `true` for FUSE file system support. [details](https://www.pivotaltracker.com/story/show/121154097)\n- Added `capi.stager.diego_privileged_containers` (default `false`) to run containers on Diego in unprivileged mode. Must be changed to `true` for FUSE file system support. [details](https://www.pivotaltracker.com/story/show/121154097)\n- Added `router.enable_proxy` (default `false`) to enable PROXY protocol support.\n- Renamed `router.debug_addr` to `router.debug_address`.\n- Added `dea_next.dns_servers` property to allow containers to have a defined set of dns servers different than the host.\n\n## \u003ca name='recommended-bosh-stemcell-versions'\u003e\u003c/a\u003eRecommended BOSH Stemcell Versions\n- AWS: light-bosh-stemcell-3262.2-aws-xen-hvm-ubuntu-trusty-go_agent\n- vSphere: bosh-stemcell-3262.2-vsphere-esxi-ubuntu-trusty-go_agent\n- OpenStack: N/A\n- BOSH-Lite: bosh-stemcell-3262.2-warden-boshlite-ubuntu-trusty-go_agent\n\nThese are soft recommendations; several different versions of the stemcells are likely to work fine with this version of cf-release and the corresponding versions of the additional releases listed below.\n\n## \u003ca name='recommended-versions-additional-releases'\u003e\u003c/a\u003eRecommended Versions of Additional Releases\n\nThese versions are soft recommendations, as several different versions of these releases may work correctly with this version of cf-release.\n- Diego release [v0.1480.0](https://github.com/cloudfoundry/diego-release/tree/v0.1480.0).\n  Release notes for\n  [v0.1480.0](https://github.com/cloudfoundry/diego-release/releases/tag/v0.1480.0) ·\n  [v0.1479.0](https://github.com/cloudfoundry/diego-release/releases/tag/v0.1479.0) ·\n  [v0.1478.0](https://github.com/cloudfoundry/diego-release/releases/tag/v0.1478.0) ·\n  [v0.1477.0](https://github.com/cloudfoundry/diego-release/releases/tag/v0.1477.0).\n- Garden-Linux release [v0.339.0](https://github.com/cloudfoundry-incubator/garden-linux-release/tree/v0.339.0).\n  Release notes for\n  [v0.339.0](https://github.com/cloudfoundry-incubator/garden-linux-release/releases/tag/v0.339.0).\n- etcd release [v60](https://github.com/cloudfoundry-incubator/etcd-release/tree/v60). Release notes for\n  [v60](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v60) ·\n  [v59](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v59) ·\n  [v58](https://github.com/cloudfoundry-incubator/etcd-release/releases/tag/v58).\n- cflinuxfs2-rootfs release [v1.18.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/tree/v1.18.0).\n  Release notes for\n  [v1.18.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.18.0) ·\n  [v1.17.0](https://github.com/cloudfoundry/cflinuxfs2-rootfs-release/releases/tag/v1.17.0).\n"
}