{
  "Content": "## Release Notes\n\nThe cf-release v213 was released on July 9, 2015.\n\n_IMPORTANT_: This release has a backwards incompatible Cloud Controller database migration that causes downtime for Cloud Controller during the deploy.  We are working on getting this sorted out.  We don't recommend upgrading to this release.\n1. [CC and Service Broker APIs](#cc-and-service-broker-apis)\n2. [Runtime](#runtime)\n3. [Buildpacks](#buildpacks)\n4. [Identity](#identity)\n5. [Routing](#routing)\n6. [Log Aggregation and Metrics](#log-aggregation-and-metrics)\n7. [Manifest Template and Job Spec Changes](#manifest-template-and-job-spec-changes)\n8. [Recommended BOSH Release and Stemcell Versions](#recommended-bosh-release-and-stemcell-versions)\n9. [Recommended Diego Version](#recommended-diego-version)\n\n### CC and Service Broker APIs\n\n**CC API Version: 2.33.0**\n\n**Service Broker API Version: 2.6**\n- Removed space_id from events [details](https://www.pivotaltracker.com/story/show/92445592)\n  - NOTE: This caused the backwards incompatible ccdb migration.  During the deploy of 213, there will be cloud controller down time while the cloud controller job is rolling.  This issue is fixed in the next cf-release [details](https://www.pivotaltracker.com/story/show/98701792)\n- Split client max body size manifest configuration [details](https://www.pivotaltracker.com/story/show/95263120)\n  - `cc.client_max_body_size` default decreased to 15M on body size for requests to cloud controller\n  - `cc.app_bits_max_body_size` new property added that controls the max body size for application bits sent to cloud controller for app upload with default 1536M\n- Switch buildpack cache key to be #{guid}-#{stack.name} [details](https://www.pivotaltracker.com/story/show/95741490)\n  - Recommend cleaning up the buildpack cache by using the buildpack_cache delete end point after upgrading to this release to reclaim the space used by caches with the older cache key.  For large deployments, this end point may take some time and may need to be called again if it times out. [apidoc](http://apidocs.cloudfoundry.org/212/blobstores/delete_all_blobs_in_the_buildpack_cache_blobstore.html)\n- Removed billing events api and associated models [details](https://www.pivotaltracker.com/story/show/92455198)\n- [Experimental] Work continues on /v3 and Application Process Types [details](https://www.pivotaltracker.com/epic/show/1334418)\n- [Experimental] Work started on Private Brokers [details](https://www.pivotaltracker.com/epic/show/1958398)\n- API work on Service Keys epic complete [details](https://www.pivotaltracker.com/epic/show/1965164)\n- API work on Instance Tags epic complete [details](https://www.pivotaltracker.com/epic/show/1960930)\n- API work on Service ID included in service request to Service Broker completed (https://www.pivotaltracker.com/epic/show/1965166)\n- As cloud controller admin, I can add a new stack to cloud controller POST /v2/stacks [details](https://www.pivotaltracker.com/story/show/89666562) | [apidoc](http://apidocs.cloudfoundry.org/213/stacks/creates_a_stack.html)\n  - This end point allows the creation of stacks that cloud controller knows about.  The stack would additionally need to be advertised/supported by a DEA or Cell in order for an app requesting the stack to be placed.\n- Private domain limit added to org quota definition [details](https://www.pivotaltracker.com/story/show/92102714) | [apidoc](http://dieu-test.cfapps.io/213/organization_quota_definitions/creating_a_organization_quota_definition.html)\n- Space Developer can now download an app's droplet [details](https://www.pivotaltracker.com/story/show/95890146) |  [apidoc](http://apidocs.cloudfoundry.org/213/apps/downloads_the_staged_droplet_for_an_app.html)\n- Added statsd metrics to cc [details](https://www.pivotaltracker.com/story/show/97548610)\n- Added metrics on delayed job queue [details](https://www.pivotaltracker.com/story/show/96912938)\n- Additional logging added around blobstore access in cc logs[details](https://www.pivotaltracker.com/story/show/96212820)\n- user guid and request id logged at the beginning of the request in cc logs.[details](https://www.pivotaltracker.com/story/show/96909028)\n- Additional cc logs to include response code and vcap request id for requests to cc [details](https://www.pivotaltracker.com/story/show/96219796)\n- Ensure nfs mount exists before starting cc and cc worker jobs [details](https://www.pivotaltracker.com/story/show/98158086)\n- Update nginx config to allow `cf files` to get _application_ and _bits_ [details](https://www.pivotaltracker.com/story/show/85564044)\n- Added staging error message to /v2/apps/:guid [details](https://www.pivotaltracker.com/story/show/95452896)\n- Added a meaningful error when request fails due to issues writing to ccdb[details](https://www.pivotaltracker.com/story/show/95107930)\n- When changing a plan, user should not see that the plan has changed until the update succeeds [details](https://www.pivotaltracker.com/story/show/97844326)\n- only user with SpaceDeveloper role should be able to obtain dashboard_url [details](https://www.pivotaltracker.com/story/show/96232826)\n- when attempting to recursively delete an org containing a service instance with bound applications, user should receive an error message indicating which service instance is the problem [details](https://www.pivotaltracker.com/story/show/96924852)\n- Admins can delete the last OrgManager on an Organization [details](https://www.pivotaltracker.com/story/show/96173310)\n\n### Runtime\n\n#### [DEA](https://github.com/cloudfoundry/dea_ng/tree/dea263210ea8032baf10a83c187c99c4037bb2b7)\n- Mask sensitive data (e.g. VCAP_SERVICES and environment variables) in logs. [details](https://www.pivotaltracker.com/story/show/92954568)\n\n#### [Warden](https://github.com/cloudfoundry/warden/tree/82042e8bae26428343f422605fb1b4890f11a37b)\n- Mask sensitive data (e.g. VCAP_SERVICES and environment variables) in logs. [details](https://www.pivotaltracker.com/story/show/92954568)\n- Disk quotas no longer break when rootfs already contains `vcap` user. [details](https://www.pivotaltracker.com/story/show/95694242)\n- Move extraction of `cflinuxfs2` rootfs into the DEA job to ensure the ownership of `/home/vcap` in the rootfs is `vcap:vcap`. [details](https://www.pivotaltracker.com/story/show/97832746)\n\n### Buildpacks\n\n#### staticfile-buildpack v1.2.0\n\nhttps://github.com/cloudfoundry/staticfile-buildpack/releases/tag/v1.2.0\n- Remove nginx version display\n  (https://www.pivotaltracker.com/story/show/94542440)\n- Remove lucid-specific binaries from manifest.yml\n  (https://www.pivotaltracker.com/story/show/96135874)\n- Give helpful message on unsupported stacks\n  (https://www.pivotaltracker.com/story/show/96590146)\n\nhttps://github.com/cloudfoundry/staticfile-buildpack/releases/tag/v1.1.1\n- Bump compile extensions\n  (https://www.pivotaltracker.com/story/show/96957294)\n\n#### ruby-buildpack v1.5.0\n\nhttps://github.com/cloudfoundry/ruby-buildpack/releases/tag/v1.5.0\n- Remove lucid-specific binaries from manifest.yml\n  (https://www.pivotaltracker.com/story/show/96135874)\n- Give helpful message on unsupported stacks\n  (https://www.pivotaltracker.com/story/show/96590188)\n- Use cloudfoundry java team built OpenJdks\n  (https://www.pivotaltracker.com/story/show/94123750)\n\n#### python-buildpack v1.4.0\n\nhttps://github.com/cloudfoundry/python-buildpack/releases/tag/v1.4.0\n- Remove 2.7.8 from skinny manifest\n- Remove lucid-specific binaries from manifest.yml\n  (https://www.pivotaltracker.com/story/show/96135874)\n- alert user about incompatible stack usage\n  (https://www.pivotaltracker.com/story/show/96137338)\n\n#### php-buildpack v3.3.0\n\nhttps://github.com/cloudfoundry/php-buildpack/releases/tag/v3.3.0\n- Fail with helpful error message for incompatible stack\n  (https://www.pivotaltracker.com/story/show/96590154)\n- Remove lucid-specific binaries from manifest.yml\n  (https://www.pivotaltracker.com/story/show/96135874)\n- Add PHP 5.6.8, 5.5.24, 5.4.40 to unsupported manifest\n  (https://www.pivotaltracker.com/story/show/94988124)\n\n#### nodejs-buildpack v1.4.0\n\nhttps://github.com/cloudfoundry/nodejs-buildpack/releases/tag/v1.4.0\n- Merge upstream changes from Heroku (sha: f1b195427424922274807151e0dd8d1948d03ebb):\n  - Improvements to app caching logic\n- Remove lucid-specific binaries from manifest.yml\n  (https://www.pivotaltracker.com/story/show/96135874)\n- Give helpful message on unsupported stacks\n  (https://www.pivotaltracker.com/story/show/96590188)\n\n#### go-buildpack v1.4.0\n\nhttps://github.com/cloudfoundry/go-buildpack/releases/tag/v1.4.0\n- Remove lucid64 references from manifest.yml\n  (https://www.pivotaltracker.com/story/show/96135874)\n- Alert user about incompatible stack usage\n  (https://www.pivotaltracker.com/story/show/96590164)\n- Fail staging on missing resource\n  (https://www.pivotaltracker.com/story/show/95737420)\n- Update Godeps instructions\n  (https://www.pivotaltracker.com/story/show/94986104)\n\n#### binary-buildpack v1.0.1\n\nhttps://github.com/cloudfoundry/binary-buildpack/releases/tag/v1.0.1\n- Make compile and detect proper scripts\n  (https://www.pivotaltracker.com/story/show/96882956)\n\n### Identity\n- Bumped UAA to version 2.4.0 [details](https://github.com/cloudfoundry/uaa/releases/tag/2.4.0)\n\n### Routing\n- Work continues on support for route services [details](https://www.pivotaltracker.com/epic/show/1884060)\n- Moved gorouter and routing-api source to src/github.com [details](https://www.pivotaltracker.com/story/show/96579464)\n- Routing API debug port changed so as not to conflict with GoRouter's [details](https://www.pivotaltracker.com/story/show/96817418)\n- Routes can no longer be registered with the Routing API with ports greater than 65536 [details](https://www.pivotaltracker.com/story/show/97346052)\n- Routing API now emits metrics for operational visibility using Metron agent [details](https://www.pivotaltracker.com/story/show/85546998)\n\n### Log Aggregation and Metrics\n\nNo Changes.\n\n### Manifest Template and Job Spec Changes\n- Removed `cc.billing_event_writing_enabled`. [details](https://www.pivotaltracker.com/story/show/92455198)\n- Removed `cc.diego_docker`. [details](https://www.pivotaltracker.com/story/show/95275686)\n- Added `nfs_server.share_path`. [details](https://www.pivotaltracker.com/story/show/98158086)\n- Split `cc.client_max_body_size` and `cc.app_bits_max_body_size` to allow setting separate limits on request payload size to Cloud Controller (allow for a larger limit in the case of application bits upload).\n- Added `cc.statsd_host` and `cc.statsd_port`. [details](https://www.pivotaltracker.com/story/show/97548610)\n- Added `router.ssl_skip_validation`. [details](https://www.pivotaltracker.com/story/show/97578180)\n- Removed `loggregator.incoming_port`. [details](https://www.pivotaltracker.com/story/show/76284328)\n- Removed `routing-api.consul_ttl` and `routing-api.lock_retry_interval`. [details](https://www.pivotaltracker.com/story/show/96899334)\n- Changed `consul.agent.services` from a list to a map. [details](https://www.pivotaltracker.com/story/show/94465558)\n- Changed default data within `dea_next.stacks` to expect the `cflinuxfs2` rootfs to live at `/var/vcap/packages/rootfs_cflinuxfs2/rootfs`. [details](https://www.pivotaltracker.com/story/show/97832746)\n- Changed default for `routing-api.debug_address`. [details](https://www.pivotaltracker.com/story/show/96817418)\n- Added `uaa.password.policy.minLength`, `uaa.password.policy.maxLength`, `uaa.password.policy.requireUpperCaseCharacter`, `uaa.password.policy.requireLowerCaseCharacter`, `uaa.password.policy.requireDigit`, `uaa.password.policy.requireSpecialCharacter`, and `uaa.password.policy.expirePasswordInMonths`. [details]\n- Added `login.saml.entity_base_url`. [details](https://www.pivotaltracker.com/story/show/96567690)\n- Changed default value of `router.enable_routing_api` from `false` to `true`.\n- Set default value of `uaa.scim.user.override` to `true`, and changed default value of `uaa.scim.userids_enabled` from `false` to `true`. [details](https://www.pivotaltracker.com/story/show/98039704)\n\n### Recommended BOSH Release and Stemcell Versions\n- BOSH Release Version: [152](http://bosh.io/releases/github.com/cloudfoundry/bosh?version=152)\n- BOSH Stemcell Version:\n  - Runner Jobs: [bosh-aws-xen-ubuntu-trusty-go_agent](http://bosh.io/stemcells/bosh-aws-xen-ubuntu-trusty-go_agent) 2989\n  - Non-Runner Jobs: [bosh-aws-xen-hvm-ubuntu-trusty-go_agent](http://bosh.io/stemcells/bosh-aws-xen-hvm-ubuntu-trusty-go_agent) 2989\n\nThese are soft recommendations; several different versions of the BOSH release and stemcell are likely to work fine.  In future deployments, we will be migrating all Runner VMs to the new HVM instance types.\n\n### Recommended Diego Version\n- Final Release [0.1353.0](https://github.com/cloudfoundry-incubator/diego-release/tree/0.1353.0)\n"
}