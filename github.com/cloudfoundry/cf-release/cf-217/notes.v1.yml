{
  "Content": "The cf-release v217 was released on September 09, 2015.\n\n**Important:**\n- This release introduces significant improvements to the security of the consul cluster, however the operator must introduce these changes over the course of multiple deployments.  If you are not running any consul servers as part of your deployment, you can ignore these instructions.  Otherwise, please do the following:  \n  1. Scale the number of consul servers in your existing deployment down to 1 instance.  The `consul.agent.servers.lan` property must be updated to reflect this; this should happen for free if you are using the standard tooling for manifest generation.  If you are deploying Diego alongside CF, you must redeploy Diego as well to pick up the `consul.agent.servers.lan` change; again, this should happen for free if using the standard manifest generation tooling.  \n  2. Generate SSL certificates, keys, and a separate encryption key for the gossip protocol used by consul ([instructions](https://docs.cloudfoundry.org/deploying/consul-security.html)).  Upload the v217 release and generate your manifest for CF (and then Diego, if also deploying Diego).\n  3. Deploy CF (and then Diego, if also deploying Diego).\n  4. Scale the number of consul servers back up to whatever you had it at before.  Regenerate all relevant manifests and deploy.\n- cf-release v216 was skipped.  After cutting a final release, the final release changes need to be committed back to the repo.  We do one final deploy of the final release before committing its changes to master.  In this case, a bug was found after doing the deploy, so we did not commit its changes.  The bug was fixed, a new final release was deployed, and its changes have been committed.  Since the director where the deploy was done already had a 216 deployed to it, we could not call the fixed release 216 as well, hence 217.\n\n**Contents:**\n- \u003ca href='#cc-and-service-broker-apis'\u003eCC and Service Broker APIs\u003c/a\u003e\n- \u003ca href='#runtime'\u003eRuntime\u003c/a\u003e\n- \u003ca href='#buildpacks-and-stacks'\u003eBuildpacks and Stacks\u003c/a\u003e\n- \u003ca href='#routing'\u003eRouting\u003c/a\u003e\n- \u003ca href='#loggregator'\u003eLoggregator\u003c/a\u003e\n- \u003ca href='#internal-components'\u003eInternal Components\u003c/a\u003e\n- \u003ca href='#job-spec-changes'\u003eJob Spec Changes\u003c/a\u003e\n- \u003ca href='#recommended-bosh-release-and-stemcell-versions'\u003eRecommended BOSH Release and Stemcell Versions\u003c/a\u003e\n- \u003ca href='#recommended-diego-version'\u003eRecommended Diego Version\u003c/a\u003e\n- \u003ca href='#recommended-garden-linux-version'\u003eRecommended Garden Linux Version\u003c/a\u003e\n\n## \u003ca name='cc-and-service-broker-apis'\u003e\u003c/a\u003eCC and Service Broker APIs\n\n**CC API Version: 2.35.0**\n\n**Service Broker API Version: 2.6**\n\n#### [Cloud Controller](https://github.com/cloudfoundry/cloud_controller_ng/tree/1cf56e361b6f64b1c982d15550ab0d3c068872a8)\n- [Experimental] Work continues on /v3 and Application Process Types [details](https://www.pivotaltracker.com/epic/show/1334418)\n- [Experimental] Work continues on Private Brokers [details](https://www.pivotaltracker.com/epic/show/1958398)\n- [Experimental] Work reverted on Dashboard Clients per Service Instance [details](https://www.pivotaltracker.com/epic/show/1958396)\n- [Experimental] Work started on Route Services [details](https://www.pivotaltracker.com/epic/show/1884060)\n- cloudfoundry/cloud_controller_ng #411: Update cf-message-bus which includes latest NATS client [details](https://www.pivotaltracker.com/story/show/100812456)\n- Add a description to the Resource Match API page to apidocs [details](https://www.pivotaltracker.com/story/show/100654666)\n- Add description for recursive delete flag on [Orgs](http://apidocs.cloudfoundry.org/217/organizations/delete_a_particular_organization.html) and [Spaces](http://apidocs.cloudfoundry.org/217/spaces/delete_a_particular_space.html) to apidocs [details](https://www.pivotaltracker.com/story/show/93405996)\n- Update ruby version to 2.1.7 [details](https://www.pivotaltracker.com/n/projects/1382120/stories/101622028)\n- Remove experimental flags for `total_private_domains` and `app_instance_limit` in Creating a Organization Quota Definition [details](https://www.pivotaltracker.com/story/show/100090134)\n- Added new endpoint to get number of started instances by Org `GET /v2/organizations/:guid/instance_usage` [apidoc](http://apidocs.cloudfoundry.org/217/organizations/retrieving_organization_instance_usage.html) [details](https://www.pivotaltracker.com/story/show/92592742)\n\n## \u003ca name='runtime'\u003e\u003c/a\u003eRuntime\n\n#### [DEA](https://github.com/cloudfoundry/dea_ng/commit/d53d1fd3bde0d05e1ec21d10f913515a57ca5ae3)\n- Bump ruby version to 2.1.7. [details](https://www.pivotaltracker.com/story/show/101622028)\n- Bump NATS client. [details](https://www.pivotaltracker.com/story/show/100812218)\n\n#### [Warden](https://github.com/cloudfoundry/warden/commit/9ea15c0c15df059acace1c8f121e2f7134ce5187)\n- Remove guard against using aufs for nested warden containers to match current garden behavior. [details](https://github.com/cloudfoundry/warden/commit/9ea15c0c15df059acace1c8f121e2f7134ce5187)\n- Bump ruby version to 2.1.7. [details](https://www.pivotaltracker.com/story/show/101622028)\n\n#### [HM9000](https://github.com/cloudfoundry/hm-workspace/commit/1117f9edd5641c887c7091a330546048f85e044d)\n\nNo functional changes.\n\n## \u003ca name='buildpacks-and-stacks'\u003e\u003c/a\u003eBuildpacks and Stacks\n\n### stacks\n\nupdated to 1.7.0 (from 1.4.0)\n\n#### [1.7.0](https://github.com/cloudfoundry/stacks/releases/tag/1.7.0)\n\nNotably, this release addresses [USN-2726-1](http://www.ubuntu.com/usn/usn-2726-1), \"Expat vulnerability\", which is related to [CVE-2015-1283](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2015-1283).\n\n#### [1.6.0](https://github.com/cloudfoundry/stacks/releases/tag/1.6.0)\n\nNotably, this release addresses [USN-2722-1](http://www.ubuntu.com/usn/usn-2722-1), \"gdk-pixbuf vulnerability\".\n\n#### [1.5.0](https://github.com/cloudfoundry/stacks/releases/tag/1.5.0)\n\nNotably, this release addresses:\n- [USN-2710-1](http://www.ubuntu.com/usn/usn-2710-1/), \"OpenSSH vulnerabilities\"\n- [USN-2710-2](http://www.ubuntu.com/usn/usn-2710-2/), \"openssh regression\"\n\nwhich are related to:\n- [CVE-2015-5352](http://people.ubuntu.com/~ubuntu-security/cve/CVE-2015-5352)\n- [CVE-2015-5600](http://people.ubuntu.com/~ubuntu-security/cve/CVE-2015-5600)\n\nin addition to two other vulnerabilities which do not yet have CVE numbers assigned.\n\n### go-buildpack\n\nupdated to v1.6.0 (from v1.5.0)\n\n#### [v1.6.0](https://github.com/cloudfoundry/go-buildpack/releases/tag/v1.6.0)\n- Output buildpack information in detect script.\n  (https://www.pivotaltracker.com/story/show/100757820)\n- Add go 1.5.\n  Remove go 1.1.x, which hasn't been updated since August 2013.\n  (https://www.pivotaltracker.com/story/show/101620562)\n\nPackaged binaries:\n\n| name | version | cf_stacks |\n| --- | --- | --- |\n| go | 1.2.1 | cflinuxfs2 |\n| go | 1.2.2 | cflinuxfs2 |\n| go | 1.3.2 | cflinuxfs2 |\n| go | 1.3.3 | cflinuxfs2 |\n| go | 1.4.1 | cflinuxfs2 |\n| go | 1.4.2 | cflinuxfs2 |\n| go | 1.5 | cflinuxfs2 |\n\n### ruby-buildpack\n\nupdated to v1.6.5 (from v1.6.2)\n\n#### [v1.6.5](https://github.com/cloudfoundry/ruby-buildpack/releases/tag/v1.6.5)\n- Change default Ruby version to '2.2.3'\n  (https://www.pivotaltracker.com/story/show/101779882)\n\nPackaged binaries:\n\n| name | version | cf_stacks |\n| --- | --- | --- |\n| ruby | 2.0.0 | cflinuxfs2 |\n| ruby | 2.1.6 | cflinuxfs2 |\n| ruby | 2.1.7 | cflinuxfs2 |\n| ruby | 2.2.2 | cflinuxfs2 |\n| ruby | 2.2.3 | cflinuxfs2 |\n| jruby | ruby-1.9.3-jruby-1.7.21 | cflinuxfs2 |\n| jruby | ruby-2.0.0-jruby-1.7.21 | cflinuxfs2 |\n| jruby | ruby-2.2.2-jruby-9.0.0.0 | cflinuxfs2 |\n| node | 0.12.7 | cflinuxfs2 |\n| bundler | 1.9.7 | cflinuxfs2 |\n| libyaml | 0.1.6 | cflinuxfs2 |\n| openjdk1.8-latest | 1.8.0_51 | cflinuxfs2 |\n| rails3_serve_static_assets | - | cflinuxfs2 |\n| rails_log_stdout | - | cflinuxfs2 |\n\n#### [v1.6.4](https://github.com/cloudfoundry/ruby-buildpack/releases/tag/v1.6.4)\n\nNote that v1.6.3 was not released.\n- Add support for Ruby 2.1.7 and 2.0.0-p647, which addresses CVE-2015-3900.\n  Remove support for Ruby 2.1.5 and 2.0.0-p645.\n  (https://www.pivotaltracker.com/story/show/101589968)\n\n## \u003ca name='identity'\u003e\u003c/a\u003eIdentity\n\nUpdated to [UAA Release 2.6.1](https://github.com/cloudfoundry/uaa/releases/tag/2.6.1)\n\n## \u003ca name='routing'\u003e\u003c/a\u003eRouting\n- Work continues on support for Route Services [details](https://www.pivotaltracker.com/epic/show/1884060), [more details](https://www.pivotaltracker.com/epic/show/2031344)\n- Gorouter now logs X-Forwarded-Proto [details](https://www.pivotaltracker.com/story/show/100903618)\n- Gorouter no longer responds to a publish NATS message with an empty subject [details](https://www.pivotaltracker.com/story/show/83255764)\n- Work begun on support for TCP Routing in Routing API [details](https://www.pivotaltracker.com/epic/show/2025854)\n- Routing API no longer logs the Authorization header [details](https://www.pivotaltracker.com/story/show/101296508)\n- A bug was introduced in v217 wherein gorouter logs are no longer rotated as frequently as they used to be. This could lead to failure if the disk fills up. A fix has been committed and will be included in v219 [details](https://www.pivotaltracker.com/story/show/103558422).\n\n## \u003ca name='loggregator'\u003e\u003c/a\u003eLoggregator\n\n## \u003ca name='internal-components'\u003e\u003c/a\u003eInternal Components\n\n#### etcd\n\nNo functional changes.\n\n#### consul\n- Improve operability of consul cluster when scaling down. [details](https://www.pivotaltracker.com/story/show/101154334)\n- Consul servers determine whether they are synced with the rest of the cluster in the officially recommended manner. [details](https://www.pivotaltracker.com/story/show/99669458)\n- Consul agents and servers communicate securely with one another. [details](https://www.pivotaltracker.com/story/show/100841008)\n- Consul servers leave and join the cluster more reliably during a rolling deploy. [details](https://www.pivotaltracker.com/story/show/102482120)\n\n#### route_registrar\n- Added new `route_registrar` job to centralize route registration logic in one place, and move it out of the source code of other components that aren't primarily concerned with route registration. [details](https://www.pivotaltracker.com/story/show/99063270)\n\n## \u003ca name='job-spec-changes'\u003e\u003c/a\u003eJob Spec Changes\n- Removed `networks.apps` property from all jobs. [details](https://www.pivotaltracker.com/story/show/100583018)\n- Removed numerous unused properties:  \n  - Removed `cc.internal_service_hostname`, `cc.jobs.model_deletion.timeout_in_seconds`, `cc.info.support_address`, and `ccdb.max_ar_connections` from all CC-related jobs.  \n  - Removed `uaa.clients.cloud_controller_username_lookup.client` from `cloud_controller_ng` spec.  \n  - Removed `nats_props` from `nats_stream_forwarder` spec.\n- Added `cc.diego.nsync_url`, `cc.diego.stager_url`, and `cc.diego.tps_url` to all CC-related jobs. [details](https://www.pivotaltracker.com/story/show/100141158)\n- Added `consul.require_ssl`, `consul.ca_cert`, `consul.server_cert`, `consul.server_key`, `consul.agent_cert`, `consul.agent_key`, and `consul.encrypt_keys` to `consul_agent` job. [details](https://www.pivotaltracker.com/story/show/100841008)\n- Added `doppler.sink_dial_timeout_seconds` and `doppler.sink_io_timeout_seconds` to `doppler` spec. [details](https://www.pivotaltracker.com/story/show/101588264)\n- Added `router.logrotate.freq_min`, `router.logrotate.rotate`, `router.logrotate.size`, and `router.extra_headers_to_log` to `gorouter` spec. [details](https://www.pivotaltracker.com/story/show/100831918)\n- Removed `traffic_controller.host` and `traffic_controller.incoming_port` from `loggregator_trafficcontroller` spec. [details](https://www.pivotaltracker.com/story/show/101913180)\n- Added `metron_agent.logrotate.freq_min`, `metron_agent.logrotate.rotate`, and `metron_agent.logrotate.size` to `metron_agent` spec. [details](https://www.pivotaltracker.com/story/show/100832060)\n- Added `uaa.logging_level` to `uaa` job. [details](https://www.pivotaltracker.com/story/show/101938134)\n- Added `login.prompt.username.text` and `login.prompt.password.text` to `uaa` job. [details](https://www.pivotaltracker.com/story/show/101938726)\n\n## \u003ca name='recommended-bosh-release-and-stemcell-versions'\u003e\u003c/a\u003eRecommended BOSH Release and Stemcell Versions\n- BOSH Release Version: bosh/201\n- BOSH Stemcell Version(s): bosh-aws-xen-hvm-ubuntu-trusty-go_agent/3026\n\nThese are soft recommendations; several different versions of the BOSH release and stemcell are likely to work fine with this version of cf-release.\n\n## \u003ca name='recommended-diego-version'\u003e\u003c/a\u003eRecommended Diego Version\n- Diego final release [0.1428.0](https://github.com/cloudfoundry-incubator/diego-release/tree/0.1428.0) · [release notes](https://github.com/cloudfoundry-incubator/diego-release/releases/tag/0.1428.0)\n\nThis is a soft recommendation; several different versions of the diego-release may work fine with this version of cf-release.\n\n## \u003ca name='recommended-garden-linux-version'\u003e\u003c/a\u003eRecommended Garden Linux Version\n- garden-linux Release Version: garden-linux/0.303.0\n\nThis is a soft recommendation; several different versions of the garden-linux release may work fine with this version of cf-release and the aforementioned version of diego-release.\n"
}