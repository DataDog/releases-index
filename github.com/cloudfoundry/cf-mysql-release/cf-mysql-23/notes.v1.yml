{
  "Content": "## Updated MariaDB\n- Operator should be able to verify that cf-mysql-release includes MariaDB 10.0.21 and Galera library 25.3.9 [[#99853996](https://www.pivotaltracker.com/story/show/99853996)]\n\n## Bug Fixes\n- CVE-2015-3900: MITM rubygems vulnerability [[#101620234](https://www.pivotaltracker.com/story/show/101620234)]\n- An Operator should be able to deploy cf-mysql on vSphere using the provided sample stub [[#100774212](https://www.pivotaltracker.com/story/show/100774212)]\n- cloudfoundry/cf-mysql-release #80: bosh deploy error : no implicit conversion of Fixnum into String [[#102881976](https://www.pivotaltracker.com/story/show/102881976)]\n\nSwitchboard:\n- Switchboard fails to find recreated mysql node when ARP cache locked by hanging SYN_SENT [[#101784830](https://www.pivotaltracker.com/story/show/101784830)]\n- Every instance of Switchboard registrars the route `proxy-0.p-mysql.` rather than changing based on AZ index [[#101778816](https://www.pivotaltracker.com/story/show/101778816)]\n- Regression: switchboard returns 500 error when fetching list of backends [[#103439908](https://www.pivotaltracker.com/story/show/103439908)]\n\nStartup:\n\nWe've done some work to ensure smooth startup for databases that have very large data sets. To understand these changes, please read the [bosh documentation](https://bosh.io/docs/deployment-manifest.html) covering the `canary_watch_time` and `update_watch_time` properties.\n- As an Operator, I want to configure how long the startup script waits for the database to come online [[#100442046](https://www.pivotaltracker.com/story/show/100442046)]\n- During long SSTs, BOSH reports job as failing forever, mysqld is not properly managed by its control script. [[#100600470](https://www.pivotaltracker.com/story/show/100600470)]\n- As an Operator, I'd like configure an overall timeout which will break down into individual timeouts for each of the MySQL job's startup phases, so that large SST's can succeed [[#100598304](https://www.pivotaltracker.com/story/show/100598304)]\n\n### Compiling and Testing\n- cf-mysql acceptance tests should use https only [[#101143514](https://www.pivotaltracker.com/story/show/101143514)]\n- cf-mysql-broker compilation fails if workstation has mysql installed rather than mariadb [[#101706476](https://www.pivotaltracker.com/story/show/101706476)]\n- mysql-broker fails because of mysql2 gem packaging issue [[#98972188](https://www.pivotaltracker.com/story/show/98972188)]\n- Native extensions for mysql2 gem should be build during compilation stage [[#101784138](https://www.pivotaltracker.com/story/show/101784138)]\n- cloudfoundry/cf-mysql-release #79: allow configureable smoke test password [[#102174066](https://www.pivotaltracker.com/story/show/102174066)]\n- Users that have built older dev releases of cf-mysql prior to updating to v23 may encounter the following error when running `./update`:\n  \n  ```\n  error: The following untracked working tree files would be overwritten by checkout:\n    packages/ruby/packaging\n    packages/ruby/spec\n  Please move or remove them before you can switch branches.\n  ```\n  \n  This can be fixed by running `rm -r ./packages/ruby \u0026\u0026 ./update`.\n\n## Documentation Updates\n- New document: [Known Issues](https://github.com/cloudfoundry/cf-mysql-release/blob/master/docs/Known-Issues.md)\n- Clarify that additional cf security groups are not required to run cf-mysql since cf v211 [[#100047222](https://www.pivotaltracker.com/story/show/100047222)]\n- As an Operator, I'd like the sample stubs to follow the convention of using REPLACE for every place a stub should be modified [[#99473360](https://www.pivotaltracker.com/story/show/99473360)]\n- Add [[#100600470](https://www.pivotaltracker.com/story/show/100600470)] as a **known issue** in cf-mysql-release [[#100598530](https://www.pivotaltracker.com/story/show/100598530)]\n- All templates should have the same comment/description about meta:environment property [[#99474804](https://www.pivotaltracker.com/story/show/99474804)]\n\n### Standalone\n\nWe've done some work to allow cf-mysql-release to start up without relying on a running cf-release. This work is still in progress, but here are the stories that have been completed: [[#84945758](https://www.pivotaltracker.com/story/show/84945758)], [[#84945466](https://www.pivotaltracker.com/story/show/84945466)]], and [[#99638360](https://www.pivotaltracker.com/story/show/99638360)]\n\n## Manifest Changes\n\n**Note**: Due to changes in our manifests, `cf-mysql-release v23` requires [spiff](https://github.com/cloudfoundry-incubator/spiff) v1.0.7 or higher.\n- MySQL job\n  - Added property `database_startup_timeout`\u003cbr\u003e\n    Defines how long the startup scripts wiat for the database to come online (in seconds)\n- Proxy job\n  - Added property `proxy.proxy_ips`\n  - Added property `standalone`\n- Acceptance-tests job\n  - Added property `proxy.proxy_count` (defaults to 2)\n  - Added property `smoke_test_password` and gave it a somewhat complex default\u003cbr\u003e\n    In response to GH Issue #79, which validates a password minimum complexity feature now available in Cloud Foundry.\n\n### Special Note for bosh-lite Only\n\nIf you encounter an error when deploying:\n\n\u003e Error 400007: `cf-mysql-broker_z1/0' is not running after update\n\nCheck to see that your error output matches the example below. If they match, then you'll need to update your `cf-release` to v219 or more recent. In order to improve stability, `cf-release` switched the system domain from `10.244.0.34.xip.io` to `bosh-lite.com`. In [#104772322](https://www.pivotaltracker.com/story/show/104772322), we've updated the manifest system domain to point to `bosh-lite.com` as well. The settings in both `cf-release` and `cf-mysql-release` must match.\n\n```\nJobs\nproxy_z1\n  properties\n    ± external_host:\n      - p-mysql.10.244.0.34.xip.io\n      + p-mysql.bosh-lite.com\nproxy_z2\n  properties\n    ± external_host:\n      - p-mysql.10.244.0.34.xip.io\n      + p-mysql.bosh-lite.com\ncf-mysql-broker_z1\n  properties\n    ± cc_api_uri:\n      - https://api.10.244.0.34.xip.io\n      + https://api.bosh-lite.com\n    ± external_host:\n      - p-mysql.10.244.0.34.xip.io\n      + p-mysql.bosh-lite.com\ncf-mysql-broker_z2\n  properties\n    ± cc_api_uri:\n      - https://api.10.244.0.34.xip.io\n      + https://api.bosh-lite.com\n    ± external_host:\n      - p-mysql.10.244.0.34.xip.io\n      + p-mysql.bosh-lite.com\nbroker-registrar\n  properties\n    broker\n      ± host:\n        - p-mysql.10.244.0.34.xip.io\n        + p-mysql.bosh-lite.com\n    cf\n      ± api_url:\n        - https://api.10.244.0.34.xip.io\n        + https://api.bosh-lite.com\n      ± apps_domain:\n        - 10.244.0.34.xip.io\n        + bosh-lite.com\nbroker-deregistrar\n  properties\n    cf\n      ± api_url:\n        - https://api.10.244.0.34.xip.io\n        + https://api.bosh-lite.com\n      ± apps_domain:\n        - 10.244.0.34.xip.io\n        + bosh-lite.com\nacceptance-tests\n  properties\n    broker\n      ± host:\n        - p-mysql.10.244.0.34.xip.io\n        + p-mysql.bosh-lite.com\n    cf\n      ± api_url:\n        - https://api.10.244.0.34.xip.io\n        + https://api.bosh-lite.com\n      ± apps_domain:\n        - 10.244.0.34.xip.io\n        + bosh-lite.com\n    proxy\n      ± external_host:\n        - p-mysql.10.244.0.34.xip.io\n        + p-mysql.bosh-lite.com\n\nProperties\n± app_domains:\n  - 10.244.0.34.xip.io\n  + bosh-lite.com\ncf\n  ± api_url:\n    - https://api.10.244.0.34.xip.io\n    + https://api.bosh-lite.com\n  ± apps_domain:\n    - 10.244.0.34.xip.io\n    + bosh-lite.com\n± domain:\n  - 10.244.0.34.xip.io\n  + bosh-lite.com\n\nMeta\nNo changes\n\n\nDeploying\n---------\n\nDirector task 293\n  Started preparing deployment\n  Started preparing deployment \u003e Binding deployment. Done (00:00:00)\n  Started preparing deployment \u003e Binding releases. Done (00:00:00)\n  Started preparing deployment \u003e Binding existing deployment. Done (00:00:00)\n  Started preparing deployment \u003e Binding resource pools. Done (00:00:00)\n  Started preparing deployment \u003e Binding stemcells. Done (00:00:00)\n  Started preparing deployment \u003e Binding templates. Done (00:00:00)\n  Started preparing deployment \u003e Binding properties. Done (00:00:00)\n  Started preparing deployment \u003e Binding unallocated VMs. Done (00:00:00)\n  Started preparing deployment \u003e Binding instance networks. Done (00:00:00)\n     Done preparing deployment (00:00:00)\n\n  Started preparing package compilation \u003e Finding packages to compile. Done (00:00:00)\n\n  Started preparing dns \u003e Binding DNS. Done (00:00:00)\n\n  Started preparing configuration \u003e Binding configuration. Done (00:00:01)\n\n  Started updating job proxy_z1 \u003e proxy_z1/0 (canary). Done (00:00:41)\n  Started updating job proxy_z2 \u003e proxy_z2/0 (canary). Done (00:00:42)\n  Started updating job cf-mysql-broker_z1 \u003e cf-mysql-broker_z1/0 (canary). Failed: `cf-mysql-broker_z1/0' is not running after update (00:05:14)\n\nError 400007: `cf-mysql-broker_z1/0' is not running after update\n```\n"
}