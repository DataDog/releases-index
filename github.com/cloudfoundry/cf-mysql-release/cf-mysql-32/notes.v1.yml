{
  "Content": "In v32, we continue our efforts to solve issues and polish the release. v32 also continues our efforts to protect users from [Galera's limitations](https://mariadb.com/kb/en/mariadb/mariadb-galera-cluster-known-limitations/). We hope that these changes will make it explicit, upon moving to the service, that this is a clustered MySQL solution, and is not exactly the same a single-node deployments of MySQL/MariaDB.\n\nThe anchor change for this release is the addition of the default to _disallow_ attempts to lock tables. This could be considered a **breaking change** for new applications, so please notify your users. It's important to know, however, that table locks were never guaranteed to succeed, we're just now making it explicit.\n\n  **Deprecation Notice:** This release does not remove the privilege to lock tables from existing bindings, so it won't break any applications that are currently deployed. We plan to retroactively remove this permission in v33. [[#131408317](https://www.pivotaltracker.com/story/show/131408317)]\n\n### Features\n- service-broker created users should not be able to lock tables [[#131223773](https://www.pivotaltracker.com/story/show/131223773)]\n- Preseeded users should not be able to lock tables [[#131576399](https://www.pivotaltracker.com/story/show/131576399)]\n  \n  Table-level locks are not distributed by Galera, so `LOCK TABLES` is not supported. Rather than mysteriously let an app appear to successfully get a lock, cf-mysql v32 will now explicitly reject those attempts.\n  \n  Here's how an app would see the interaction on previous versions of cf-mysql:\n  \n  ```\n  MariaDB [cf_b236bd8f_38a4_4ee4_bf72_079fda8a6e47]\u003e LOCK TABLES fruit WRITE ;\n  Query OK, 0 rows affected (0.00 sec)\n  MariaDB [cf_b236bd8f_38a4_4ee4_bf72_079fda8a6e47]\u003e UNLOCK TABLES ;\n  Query OK, 0 rows affected (0.00 sec)\n  ```\n  \n  And here's what new applications bound to v32 and later will see:\n  \n  ```\n  MariaDB [cf_eedd5768_9c6c_4388_ae0b_dc64f4022bf4]\u003e LOCK TABLES fruit WRITE;\n  ERROR 1044 (42000): Access denied for user 'uoY64cqdw6qyMtNl'@'%' to database 'cf_eedd5768_9c6c_4388_ae0b_dc64f4022bf4'\n  MariaDB [cf_eedd5768_9c6c_4388_ae0b_dc64f4022bf4]\u003e UNLOCK TABLES;\n  Query OK, 0 rows affected (0.00 sec)\n  ```\n\n### Switchboard Changes\n- Switchboard should not expose the profiling port by default [[#129555175](https://www.pivotaltracker.com/story/show/129555175)]\n- When switchboard is being stopped, the other node should be able to acquire the consul lock quickly. [[#130918367](https://www.pivotaltracker.com/story/show/130918367)]\n  \n  When embedded in projects such as [Diego](https://github.com/cloudfoundry/diego-release), which use [consul](http://www.consul.io/) to choose a proxy to write to, failover is now on the order of one second.\n\n### Bug Fixes\n- Quota Enforcer should not block other queries from running [[#131579997](https://www.pivotaltracker.com/story/show/131579997)]\n- Proxy doesn't have privilege to clear arp cache? [[#130781143](https://www.pivotaltracker.com/story/show/130781143)]\n- Arbitrator should be optional [[PR 131](https://github.com/cloudfoundry/cf-mysql-release/pull/131)]\n- verify-cluster-schemas errand is now using bosh links [[PR 132](https://github.com/cloudfoundry/cf-mysql-release/pull/132)]\n  \n  As we move to BOSH 2.0, a user noted that the `verify-cluster-schemas` errand didn't take advantage of bosh links properly. Merged, and thank you!\n- Actually attach persistent disk in bosh2 manifests [[a549b36](https://github.com/cloudfoundry/cf-mysql-release/commit/a549b365dc2674ab5e7aa759a8cabb97c9016ac7)]\n\n### New Documentation\n- Add new documentation for bosh2 + gobosh deployment procedure: [new-deployment-procedure](docs/new-deployment-procedure.md)\n\n### Logging Changes\n- galera healthcheck logs should go to syslog [[#131564453](https://www.pivotaltracker.com/story/show/131564453)]\n\n### Interestings\n- Allow override of interrupt_notify_cmd [[#132017893](https://www.pivotaltracker.com/story/show/132017893)]\n"
}