{
  "Content": "## Introducing MariaDB 10.1\n\nThe theme for v28 is to upgrade **[MariaDB 10.1](https://mariadb.com/kb/en/mariadb/what-is-mariadb-101/)**.\n\nWe're very excited to bring this to cf-mysql, as it will unlock large improvements in stability and security. As always, we've encoded the best practices to upgrade from a MariaDB 10.0 install to MariaDB 10.1. You should be able to upgrade from a previous version of cf-mysql to v28 smoothly.\n- cf-mysql now uses MariaDB 10.1.17 and Galera 25.3.17\n  - [[#128782093](https://www.pivotaltracker.com/story/show/128782093)], [[#130140531](https://www.pivotaltracker.com/story/show/130140531)], [[#128699855](https://www.pivotaltracker.com/story/show/128699855)]\n\n### Server Configuration\n\nWe've continued to incorporate feedback from users to make additional server tweaks and defaults. These changes make the system better out of the box, and provide fewer surprises for those who aren't familiar with a Galera-based deployment.\n- I'd like Galera clusters to be restricted to just the InnoDB storage engine [[#121465037](https://www.pivotaltracker.com/story/show/121465037)]\n- Allow for override of the innodb_buffer_pool_instances [#111],  [[#123092551](https://www.pivotaltracker.com/story/show/123092551)]\n- As an Operator, I'd like to configure innodb_lock_wait_timeout so that I can tune my DB for OLTP or data-warehouse style workloads [[#129591677](https://www.pivotaltracker.com/story/show/129591677)]\n- As an Operator, I'd like to configure character_set_server to something other than the 'utf8' default [[#129592229](https://www.pivotaltracker.com/story/show/129592229)]\n- **Bug:** innodb_large_prefix disabled [[#129589643](https://www.pivotaltracker.com/story/show/129589643)]\n\n### Security\n- Permissions for log files should not allow other users to read them [[#122237641](https://www.pivotaltracker.com/story/show/122237641)]\n- Ensure logout destroys session cookies [[#128616101](https://www.pivotaltracker.com/story/show/128616101)]\n- As an Operator, I want the super user account to be named root [[#128692195](https://www.pivotaltracker.com/story/show/128692195)]\n  - **Note:** Based on user feedback, we'll make the administrator account name configurable again in a coming release. Sorry!\n\n### Manifest Generation\n- Use new UAA style name/value manifest syntax for user creation [[#113200331](https://www.pivotaltracker.com/story/show/113200331)]\n  - Now, you won't have to copy and paste your CF admin credentials into a cf-mysql stub.\n- BOSH 2.0 Manifests\n  \n  If you've started to experiment with the new [BOSH CLI](https://github.com/cloudfoundry/bosh-cli), we've started to support BOSH 2.0-style manifests. In the future, we'll move to BOSH 2.0-style manifests entirely.\n  - As an operator I would like to optionally leverage cloud-config when deploying cf-mysql-release to bosh-lite [[#128799447](https://www.pivotaltracker.com/story/show/128799447)]\n  - As an operator I would like to optionally leverage links for IPs of mysql jobs when deploying cf-mysql-release to bosh-lite [[#128799467](https://www.pivotaltracker.com/story/show/128799467)]\n\n### Proxy Improvements\n- As an Operator, I'd like the Proxies to more-deterministically choose which backend to route traffic [[#128188319](https://www.pivotaltracker.com/story/show/128188319)]\n- Add a way to set `ulimit -n' for the proxy job [#112], [[#123147571](https://www.pivotaltracker.com/story/show/123147571)]\n- Switchboard should log response from galera_healthcheck process when severing connections to a host [[#128793743](https://www.pivotaltracker.com/story/show/128793743)]\n\n### Download Logs Improvements\n\nWe've made some minor changes to the [download logs](https://github.com/cloudfoundry/cf-mysql-release/blob/v28/scripts/download-logs) script as well. This convenience script is an automated way to download logs from a variety of jobs without tedious `bosh logs` commands.\n- As an Operator, I optionally want download-logs to additionally download and transmit audit and binlogs **so that** I can avoid transmitting sensitive data to unauthorized parties and save my sanity due to large scale artifacts. [[#122885431](https://www.pivotaltracker.com/story/show/122885431)]\n- **Bug:** Unhelpful error calling download-logs without args, etc [[#122176219](https://www.pivotaltracker.com/story/show/122176219)]\n- **Bug:** Unbound variable output_dir for download-logs script  [[#123227841](https://www.pivotaltracker.com/story/show/123227841)]\n\n### Interestings\n- As an Operator, I don't want to have the option to run the Acceptance Tests [[#128466217](https://www.pivotaltracker.com/story/show/128466217)]\n  - Previous releases allowed the 'acceptance-tests' errand to run either the smoke tests or the full acceptance test suite. The latter is destructive, and there's no reason to run them outside of Continuous Integration (CI). Now, the errand is named `smoke-tests` and does the minimum necessary to validate a successful deployment.\n- Bump CLI [[#129406663](https://www.pivotaltracker.com/story/show/129406663)]\n  - Smoke tests now use a more recent version of the CLI, and a longer timeout to allow for slow DNS resolution.\n\n## Manifest Changes\n\n**Note:** For those using the current `bosh` CLI, you'll need to set links in the new manifest to `nil`. Otherwise, you may see errors like:\n\n\u003e Error 100: Unable to process links for deployment. Errors are:\n\u003e ...\n\nIn order to disable, anywhere the `consumes:` clause appears in your manifest, you must change the values to `nil`. Here's an example:\n\n```\n- name: mysql_z1\n  templates:\n  - name: mysql\n    consumes:\n      arbitrator: nil\n      mysql: nil\n```\n\n**Note:** For those using the new `bosh` CLI, you'll need to [use the guide to migrating instance groups to first-class AZs](https://bosh.io/docs/migrated-from.html#migrate).\n- Removed:\n  - `cf_mysql.mysql.admin_username`, will be back in a future release\n  - `cf_mysql.acceptance_tests.smoke_tests_only`, it is now always true\n- Added:\n  - `cf_mysql.mysql.character_set_server`, optional\n  - `cf_mysql.mysql.collation_server`, optional\n  - `cf_mysql.mysql.innodb_buffer_pool_instances`, optional\n  - `cf_mysql.mysql.innodb_lock_wait_timeout`, optional\n- Renamed:\n  - `cf_mysql.acceptance_tests.password` renamed to `cf_mysql.smoke_tests.password`\n  - `cf_mysql.acceptance_tests.standalone_tests_only` renamed to `cf_mysql.smoke_tests.standalone_tests_only`\n  - `cf_mysql.acceptance_tests.timeout_scale` renamed to `cf_mysql.smoke_tests.timeout_scale`\n"
}