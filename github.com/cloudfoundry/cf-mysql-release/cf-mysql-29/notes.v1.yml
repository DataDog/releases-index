{
  "Content": "## Security Update\n\nWhile performing an upgrade, the team discovered a security issue, CVE-2016-6653. This affects cf-mysql releases v27 and v28.\n\nIn the case where either has been deployed, and the following three conditions are true:\n- Configured to send logs to a syslog service\n- Syslog transport is not encrypted\n- Audit logging is enabled\n\n... then, cf-mysql will mistakenly send those audit logs to to the syslog service without encryption.\n\nEspecially in the case where the `query` directive has been specified in the `cf_mysql.mysql.server_audit_events` property, this can transmit all application data in a way that is not protected from network observers.\n\nFurthermore, in this configuration, BOSH will not be able to automatically upgrade, see below.\n\n### Bug Fixes\n- Do not send the mysql audit logs to syslog [[#131120795](https://www.pivotaltracker.com/story/show/131120795)]\n- Detaching the persistent disk failed when both syslog and audit logs were enabled [[#131023259](https://www.pivotaltracker.com/story/show/131023259)]\n\n### Upgrading from cf-mysql v27 or v28\n- If upgrading from v27 or v28, if both `cf_mysql.mysql.server_audit_events` property and `syslog_aggregator` had been configured, you may encounter problems when bosh tries to detach the persistent disk from the MySQL VMs. This will look like the following:\n  \n  \u003e Started updating job mysql_z1 \u003e mysql_z1/0 (55170f29-1796-48ef-ac48-abb325eec1a8) (canary). Failed: Action Failed get_task: Task 462ff34b-78ed-4d16-5ce9-fd707a45e9f1 result: Migrating persistent disk: Remounting persistent disk as readonly: Unmounting /var/vcap/store: Running command: 'umount /var/vcap/store', stdout: '', stderr: 'umount: /var/vcap/store: device is busy.\n  \u003e \n  \u003e (In some cases useful info about processes that use the device is found by lsof(8) or fuser(1))\n\nThe problem can be resolved by:\n1. Ssh onto the MySQL VMs, using your preferred method\n1. Comment out lines 44-48 of `/etc/rsyslog.d/00-syslog_forwarder.conf`\n1. `kill` the `rsyslogd` process\n1. Run `bosh deploy` again; it should succeed this time\n\n#### Features\n\nIn typical agile fashion, we had completed a few feature stories, so they're included as well.\n- galera_healthcheck should log when it encounters a bad state or error discovering state\n  [[#128880727](https://www.pivotaltracker.com/story/show/128880727)]\n  - The `galera_healthcheck` job now logs more verbosely when it encounters problems.\n- switchboard proxy should provide an HTTP healthcheck\n  [[#130696613](https://www.pivotaltracker.com/story/show/130696613)]\n  - This allows the cluster to work with Load Balancers that use only HTTP health checks.\n  - The health check port should continue to work with load balancers that use TCP health checks.\n"
}